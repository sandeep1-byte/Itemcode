@model IEnumerable<Item_Code_management_System.Models.Product>

<div class="container mt-5" style="max-height: 90vh; overflow-y: auto;">
    <h3 class="text-center mb-4 text-dark">Product List</h3>

    @if (TempData["msg"] != null)
    {
        <div id="tempMessage" class="alert alert-info mt-3">
            @TempData["msg"]
        </div>
    }

    <div class="table-responsive">
        <table class="table table-striped table-hover table-bordered text-center align-middle" style="min-width: 800px;">
            <thead class="thead-dark" style="position: sticky; top: 0; z-index: 10; background-color:white;">
                <tr>
                    <th>No</th> <!-- Changed column name from Product ID to No -->
                    <th>Item Code</th>
                    <th>Description</th>
                    <th>Price</th>
                    <th>Unit</th>
                    <th>Edit</th>
                    <th>Delete</th>
                </tr>
            </thead>
            <tbody>
                @if (Model != null && Model.Any())
                {
                    foreach (var product in Model.Select((prod, index) => new { prod, index })) // Use Select to get index
                    {
                        <tr>
                            <td>@(product.index + 1)</td> <!-- Display the index starting from 1 -->
                            <td>@product.prod.ItemCode</td>
                            <td>@product.prod.Description</td>
                            <td>@product.prod.Price.ToString("C")</td> <!-- Format price as currency -->
                            <td>@product.prod.Unit</td>
                            <td>
                                <a asp-action="Edit" asp-route-id="@product.prod.Id" class="btn btn-warning btn-sm">
                                    <i class="fas fa-edit"></i> Edit
                                </a>
                            </td>
                            <td>
                                <a asp-action="Delete" asp-route-id="@product.prod.Id"
                                   class="btn btn-danger btn-sm"
                                   onclick="return confirmDelete();">
                                    <i class="fas fa-trash-alt"></i> Delete
                                </a>
                            </td>
                        </tr>
                    }
                }
                else
                {
                    <tr>
                        <td colspan="7">No products available</td> <!-- Updated colspan to 7 -->
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<!-- JavaScript for delete confirmation -->
<script type="text/javascript">
    function confirmDelete() {
        return confirm("⚠️ Are you sure you want to delete this product? This action cannot be undone!");
    }

    // Function to automatically hide the message after a few seconds
    document.addEventListener("DOMContentLoaded", function () {
        var messageElement = document.getElementById("tempMessage");
        if (messageElement) {
            setTimeout(function () {
                messageElement.style.display = 'none';
            }, 2000); // Message will disappear after 2 seconds
        }
    });
</script>
