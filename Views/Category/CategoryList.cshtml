@model IEnumerable<Item_Code_management_System.Models.Category>

<div class="container mt-5" style="max-height: 90vh; overflow-y: auto;">
    <h3 class="text-center mb-4 text-dark">Category List</h3>

    @if (TempData["msg"] != null)
    {
        <div id="tempMessage" class="alert alert-info mt-3">
            @TempData["msg"]
        </div>
    }

    <div class="table-responsive">
        <table class="table table-striped table-hover table-bordered text-center align-middle" style="min-width: 800px;">
            <thead class="thead-dark" style="position: sticky; top: 0; z-index: 10; background-color:white;">
                <tr>
                    <th>No</th> <!-- Changed column name from Category ID to No -->
                    <th>Category Name</th>
                    <th>Edit</th>
                    <th>Delete</th>
                </tr>
            </thead>
            <tbody>
                @if (Model != null && Model.Any())
                {
                    foreach (var category in Model.Select((cat, index) => new { cat, index })) // Use Select to get index
                    {
                        <tr>
                            <td>@(category.index + 1)</td> <!-- Display the index starting from 1 -->
                            <td>@category.cat.CategoryName</td>
                            <td>
                                <a asp-action="Edit" asp-route-id="@category.cat.Id" class="btn btn-warning btn-sm">
                                    <i class="fas fa-edit"></i> Edit
                                </a>
                            </td>
                            <td>
                                <a asp-action="Delete" asp-route-id="@category.cat.Id"
                                   class="btn btn-danger btn-sm"
                                   onclick="return confirmDelete();">
                                    <i class="fas fa-trash-alt"></i> Delete
                                </a>
                            </td>
                        </tr>
                    }
                }
                else
                {
                    <tr>
                        <td colspan="4">No categories available</td> <!-- Updated colspan to 4 -->
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<!-- JavaScript for delete confirmation -->
<script type="text/javascript">
    function confirmDelete() {
        return confirm("⚠️ Are you sure you want to delete this category? This action cannot be undone!");
    }

    // Function to automatically hide the message after a few seconds
    document.addEventListener("DOMContentLoaded", function () {
        var messageElement = document.getElementById("tempMessage");
        if (messageElement) {
            setTimeout(function () {
                messageElement.style.display = 'none';
            }, 2000); // Message will disappear after 5 seconds
        }
    });
</script>
